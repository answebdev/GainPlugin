name: Build JUCE Plugin for macOS

on:
  push:
    branches:
      - main  # Trigger workflow on push to main branch

jobs:
  build:
    runs-on: macos-latest  # Use the macOS runner

    steps:
    - name: Checkout Code
      uses: actions/checkout@v2  # Checkout code from the repository

    - name: Set up Xcode
      run: |
        sudo xcode-select -s /Applications/Xcode.app/Contents/Developer  # Set Xcode as the active developer directory

    - name: Install Dependencies
      run: |
        brew install juce  # If necessary, install JUCE via Homebrew (not always required)

    - name: Generate Xcode Project with Projucer
      run: |
        cd /Users/Adolf Schmuck/Desktop/Desktop/Web-Projects/GainPlugin  # Use macOS-style path
        ./Projucer --make Xcode  # Generate the Xcode project (assuming Projucer is installed)

    - name: Build Plugin with Xcode
      run: |
        cd /path/to/your/juce/project/Builds/MacOSX  # Go to the generated Xcode build directory
        xcodebuild -project YourPlugin.xcodeproj -scheme YourPlugin -configuration Release  # Build with xcodebuild

    - name: Upload VST3 Plugin as Artifact
      uses: actions/upload-artifact@v2
      with:
        name: VST3Plugin
        path: /Users/Adolf Schmuck/Desktop/Desktop/Web-Projects/GainPlugin/Builds/VisualStudio2022/x64/Release/VST3/GainPlugin.vst3/Contents/macOS/GainMacOS.vst3  # Correct macOS path to the built plugin
